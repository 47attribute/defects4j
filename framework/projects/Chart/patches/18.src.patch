Index: org/jfree/data/DefaultKeyedValues2D.java
===================================================================
--- org/jfree/data/DefaultKeyedValues2D.java	(revision 621)
+++ org/jfree/data/DefaultKeyedValues2D.java	(revision 620)
@@ -50,7 +50,6 @@
  * 18-Jan-2007 : Fixed bug in getValue() method (DG);
  * 30-Mar-2007 : Fixed bug 1690654, problem with removeValue() (DG);
  * 21-Jun-2007 : Removed JCommon dependencies (DG);
- * 21-Nov-2007 : Fixed bug (1835955) in removeColumn(Comparable) method (DG);
  *
  */
 
@@ -439,32 +438,18 @@
     }
 
     /**
-     * Removes a column from the table.
+     * Removes a column.
      *
      * @param columnKey  the column key (<code>null</code> not permitted).
      * 
-     * @throws UnknownKeyException if the table does not contain a column with
-     *     the specified key.
-     * @throws IllegalArgumentException if <code>columnKey</code> is 
-     *     <code>null</code>.
-     * 
      * @see #removeColumn(int)
      * @see #removeRow(Comparable)
      */
     public void removeColumn(Comparable columnKey) {
-    	if (columnKey == null) {
-    		throw new IllegalArgumentException("Null 'columnKey' argument.");
-    	}
-    	if (!this.columnKeys.contains(columnKey)) {
-    		throw new UnknownKeyException("Unknown key: " + columnKey);
-    	}
         Iterator iterator = this.rows.iterator();
         while (iterator.hasNext()) {
             DefaultKeyedValues rowData = (DefaultKeyedValues) iterator.next();
-            int index = rowData.getIndex(columnKey);
-            if (index >= 0) {
-                rowData.removeValue(columnKey);
-            }
+            rowData.removeValue(columnKey);
         }
         this.columnKeys.remove(columnKey);
     }
Index: org/jfree/data/DefaultKeyedValues.java
===================================================================
--- org/jfree/data/DefaultKeyedValues.java	(revision 621)
+++ org/jfree/data/DefaultKeyedValues.java	(revision 620)
@@ -32,6 +32,8 @@
  * Original Author:  David Gilbert (for Object Refinery Limited);
  * Contributor(s):   Thomas Morgner;
  *
+ * $Id: DefaultKeyedValues.java,v 1.8.2.6 2007/04/30 15:28:04 mungady Exp $
+ *
  * Changes:
  * --------
  * 31-Oct-2002 : Version 1 (DG);
@@ -53,7 +55,6 @@
  * 30-Apr-2007 : Added insertValue() methods (DG);
  * 31-Oct-2007 : Performance improvements by using separate lists for keys and 
  *               values (TM);
- * 21-Nov-2007 : Fixed bug in removeValue() method from previous patch (DG);
  *               
  */
 
@@ -80,10 +81,8 @@
     /** For serialization. */
     private static final long serialVersionUID = 8468154364608194797L;
     
-    /** Storage for the keys. */
+    /** Storage for the data. */
     private ArrayList keys;
-    
-    /** Storage for the values. */
     private ArrayList values;
     
     /** 
@@ -115,7 +114,7 @@
      *
      * @param item  the item of interest (zero-based index).
      *
-     * @return The value (possibly <code>null</code>).
+     * @return The value.
      * 
      * @throws IndexOutOfBoundsException if <code>item</code> is out of bounds.
      */
@@ -315,25 +314,27 @@
     public void removeValue(int index) {
         this.keys.remove(index);
         this.values.remove(index);
-        rebuildIndex();
+
+        // did we remove the last item? If not, then rebuild the index ..
+        if (index < this.keys.size()) {
+            rebuildIndex();
+        }
     }
 
     /**
-     * Removes a value from the collection.
+     * Removes a value from the collection.  If there is no item with the 
+     * specified key, this method does nothing.
      *
      * @param key  the item key (<code>null</code> not permitted).
      * 
      * @throws IllegalArgumentException if <code>key</code> is 
      *     <code>null</code>.
-     * @throws UnknownKeyException if <code>key</code> is not recognised.
      */
     public void removeValue(Comparable key) {
         int index = getIndex(key);
-        if (index < 0) {
-            throw new UnknownKeyException("The key (" + key 
-                    + ") is not recognised.");
+        if (index >= 0) {
+            removeValue(index);
         }
-        removeValue(index);
     }
     
     /**
@@ -353,23 +354,23 @@
      * @param order  the sort order (<code>null</code> not permitted).
      */
     public void sortByKeys(SortOrder order) {
-        final int size = this.keys.size();
-        final DefaultKeyedValue[] data = new DefaultKeyedValue[size];
+      final int size = this.keys.size();
+      final DefaultKeyedValue[] data = new DefaultKeyedValue[size];
 
-        for (int i = 0; i < size; i++) {
-            data[i] = new DefaultKeyedValue((Comparable) this.keys.get(i), 
-                    (Number) this.values.get(i));
-        }
+      for (int i = 0; i < size; i++) {
+          data[i] = new DefaultKeyedValue((Comparable) this.keys.get(i), 
+                  (Number) this.values.get(i));
+      }
 
-        Comparator comparator = new KeyedValueComparator(
+      Comparator comparator = new KeyedValueComparator(
                 KeyedValueComparatorType.BY_KEY, order);
-        Arrays.sort(data, comparator);
-        clear();
+      Arrays.sort(data, comparator);
+      clear();
 
-        for (int i = 0; i < data.length; i++) {
-            final DefaultKeyedValue value = data[i];
-            addValue(value.getKey(), value.getValue());
-        }
+      for (int i = 0; i < data.length; i++) {
+          final DefaultKeyedValue value = data[i];
+          addValue(value.getKey(), value.getValue());
+      }
     }
 
     /**
